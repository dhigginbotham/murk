var murk=function(e){return"undefined"!=typeof module&&module.exports?module.exports=e:e}(function(e){function r(e,r,n){if("string"!=typeof r&&"undefined"==typeof n&&(n=r,r=n),n="undefined"==typeof n?!0:!1,"undefined"!=typeof r&&"string"==typeof e){if(y.model[e]=r,y.elems.hasOwnProperty(e))return t(y.elems[e])}else n?p.call(y.model,e):y.model=e;return t(),v}function n(e){return"undefined"!=typeof e?y.model.hasOwnProperty(e)?y.model[e]:null:y.model}function t(e){var r;"undefined"!=typeof e?s(e):(r=y.dom.length?y.dom:i(),Array.prototype.map.call(r,s))}function o(e){e="undefined"==typeof e?document:e;var r=i(e);Array.prototype.map.call(r,s)}function i(e){return e="undefined"==typeof e?document:e,e.getElementsByTagName("*")}function s(e){var r,n;return r=m(e),n=r(h.selectorPrefix),n&&(r(h.selectorPrefix+"-id")||r(h.selectorPrefix+"-id",h.id),r(h.selectorPrefix+"-id")==h.id&&(y.elems.hasOwnProperty(n)||(y.elems[n]=e,~y.keys.indexOf(n)||(y.keys.push(n),y.dom.push(e)),e.innerHTML&&!y.model.hasOwnProperty(n)&&(y.model[n]=e.innerHTML)),y.model.hasOwnProperty(n)?decodeURIComponent(r(h.selectorPrefix+"-val"))!=y.model[n]&&l(n):r(h.selectorPrefix+"-bound",!1))),!1}function l(e){function r(t,o){t.call(y.elems[e],e,function(e,t){return n.length?e?o(e,n):r(n.shift(),o):o(null,!0)})}y.subscribers.hasOwnProperty(e)||(y.subscribers[e]=[a,f,d]);var n=Array.prototype.slice.call(y.subscribers[e]);r(n.shift(),function(r,n){r&&console.log("error handling subscriber of "+e),h.dev&&n&&console.log("finished handling subscribers")})}function u(e,r){function n(e){y.subscribers.hasOwnProperty(e)||(y.subscribers[e]=[a,f,d]),y.subscribers[e].push(r)}return e instanceof Array?Array.prototype.map.call(e,n):n(e),v}function f(e,r){h.dev&&(console.log("trackCountEvent"),console.log(e));var n,t=m(this);return h.trackCount&&(n=t(h.selectorPrefix+"-count"),t(h.selectorPrefix+"-count",n?parseInt(n,0)+1:1)),r?r(null,!0):void 0}function d(e,r){h.dev&&(console.log("processFilters "+ ++b),console.log(e));var n=m(this),t=n(h.selectorPrefix+"-filter");if(t){-1!=t.indexOf(",")&&(t=t.split(",")),t instanceof Array||(t=[t]);for(var o=0;o<t.length;++o)if(y.filters[t[o]]&&y.model[e]){var i=y.filters[t[o]](y.model[e]);"undefined"!=typeof i&&i!=y.model[e]&&(this.innerHTML=i)}}return r?r(null,!0):void 0}function c(e,r){return e&&r&&(y.filters[e]=r),v}function a(e,r){h.dev&&(console.log("elemBindingEvent"),console.log(e));var n=m(this);return n(h.selectorPrefix+"-val",encodeURIComponent(y.model[e])),n(h.selectorPrefix+"-bound",!0),this.innerHTML=y.model[e],r?r(null,!0):void 0}function m(e){return"undefined"!=typeof e?function(e,r){return"undefined"==typeof r?this.getAttribute(e):this.setAttribute(e,r)}.bind(e):null}function p(e){if("object"==typeof this)for(var r in e)e.hasOwnProperty(r)&&(this[r]=e[r])}var y={model:{},dom:[],elems:{},subscribers:{},filters:{},keys:[],start:Date.now()},h={selectorPrefix:"data-murk",trackCount:!0,dev:!1,id:y.start};e&&p.call(h,e);var v={},b=0;return v.collectDom=o,v.emit=l,v.get=n,v.set=r,v.on=u,v.registerFilter=c,h.dev&&(v.state=y),v});