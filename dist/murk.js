var murk=function(e){return"undefined"!=typeof module&&module.exports?void(module.exports=e):e}(function(e){function r(e,r,t){if("boolean"==typeof r&&"undefined"==typeof t&&(t=r,r=t),t="undefined"!=typeof t?t:!0,"undefined"!=typeof r&&"string"==typeof e){if(P.model[e]=r,P.elems.hasOwnProperty(e))return o(P.elems[e])}else t?h(P.model,e):P.model=e;return o(),this}function t(e){return"undefined"!=typeof e?P.model.hasOwnProperty(e)?P.model[e]:null:P.model}function o(e){var r;"undefined"!=typeof e?i(e):(r=P.dom.length?P.dom:s(),Array.prototype.forEach.call(r,i))}function n(e){e="undefined"==typeof e?document:e;var r=s(e);Array.prototype.forEach.call(r,i)}function s(e){return e="undefined"==typeof e?document:e,e.getElementsByTagName("*")}function i(e){var r,t;r=m(e),t=r(b.selectorPrefix),t&&(r(b.selectorPrefix+"-id")||r(b.selectorPrefix+"-id",b.id),r(b.selectorPrefix+"-id")==b.id&&(P.elems.hasOwnProperty(t)||(P.elems[t]=e,~P.keys.indexOf(t)||(P.keys.push(t),P.dom.push(e)),e.innerHTML&&!P.model.hasOwnProperty(t)&&(P.model[t]=e.innerHTML)),P.model.hasOwnProperty(t)?P.model[t]&&x(r(b.selectorPrefix+"-val"))==P.model[t]&&"object"!=typeof P.model[t]||(l(t),++P.totalCount):r(b.selectorPrefix+"-bound",!1)))}function l(e){P.subscribers.hasOwnProperty(e)||(P.subscribers[e]=Array.prototype.slice.call(b.defaultSubscribers));for(var r=Array.prototype.slice.call(P.subscribers[e]);fn=r.shift();)fn.call(P.elems[e],e)}function a(e,r){function t(e){P.subscribers.hasOwnProperty(e)||(P.subscribers[e]=Array.prototype.slice.call(b.defaultSubscribers)),P.subscribers[e].push(r)}return e instanceof Array||(e=[e]),Array.prototype.forEach.call(e,t),this}function f(e){var r=m(e);if(r){var t=r(b.selectorPrefix+"-repeat");t&&(e.parentNode.style.display="inherit",this.hasOwnProperty(t)&&(e.innerHTML=this[t]))}}function c(e){if(P.model[e]instanceof Array){var r,t,o,n,s,i,l=!1;if(r=P.model[e],t=m(this),o=t(b.selectorPrefix+"-repeat")){if(P.repeats.hasOwnProperty(e)||(P.repeats[e]={},P.repeats.hasOwnProperty("elems")||(P.repeats[e].elems={})),s=document.createDocumentFragment(),n=Object.keys(P.repeats[e].elems),n.length>r.length)for(var a=r.length;a<n.length;++a)P.repeats[e].elems[n[a]].style.display="none";i=function(r,t){var o,n,i,a=e+".$"+t;P.repeats[e].elems.hasOwnProperty(a)||(P.repeats[e].elems[a]=this.cloneNode(!0),l=!0),o=P.repeats[e].elems[a],n=m(o),n&&(n(b.selectorPrefix,"rm"),n(b.selectorPrefix+"-repeat","rm"),n(b.selectorPrefix+"-parent",e),n(b.selectorPrefix+"-index",t),"object"==typeof r?(i=o.getElementsByTagName("*"),Array.prototype.forEach.call(i,f,r)):o.innerHTML=r,l&&s.appendChild(o))},Array.prototype.forEach.call(r,i,this),P.repeats.hasOwnProperty(e)&&l&&this.parentNode.appendChild(s)}}}function d(){var e,r=m(this);e=r(b.selectorPrefix+"-count"),r(b.selectorPrefix+"-count",e?parseInt(e,0)+1:1)}function u(e){var r,t,o;r=m(this),r&&(t=r(b.selectorPrefix+"-filter"),t&&(o=function(t){var o,n;P.filters.hasOwnProperty(t)&&P.model.hasOwnProperty(e)&&(o=r(b.selectorPrefix+"-filtered-val")?x(r(b.selectorPrefix+"-filtered-val")):null,n=P.filters[t].call(this,P.model[e]),"undefined"!=typeof n&&o!=n&&(r(b.selectorPrefix+"-filtered-val",v(n)),this.innerHTML=n))},-1!=t.indexOf(",")&&(t=t.split(",")),t instanceof Array||(t=[t]),Array.prototype.forEach.call(t,o,this)))}function p(e,r){return e&&r&&(P.filters[e]=r),this}function y(e){var r=m(this);r(b.selectorPrefix+"-bound",!0),P.model[e]instanceof Array||"object"==typeof P.model[e]||(r(b.selectorPrefix+"-val",v(P.model[e])),this.innerHTML=P.model[e])}function m(e){return"undefined"!=typeof e?function(e,r){return"undefined"==typeof r?this.getAttribute(e):"rm"==r?this.removeAttribute(e):this.setAttribute(e,r)}.bind(e):null}function h(e,r){if("object"==typeof e)for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])}if(!(this instanceof murk))return new murk(e);var P={model:{},dom:[],elems:{},repeats:{},subscribers:{},filters:{},keys:[],start:Date.now(),totalCount:0},b={selectorPrefix:"data-murk",dev:!1,id:P.start,defaultSubscribers:[c,y,u,d]};e&&h(b,e);var v=encodeURIComponent,x=decodeURIComponent;return this.collectDom=n,this.emit=l,this.get=t,this.set=r,this.on=a,this.registerFilter=p,b.dev&&(this.state=P),this});